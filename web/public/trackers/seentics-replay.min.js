!function(e,n){"use strict";if(e.SEENTICS_CORE)r();else var s=setInterval(function(){e.SEENTICS_CORE&&(clearInterval(s),r())},100);function r(){var s=e.SEENTICS_CORE,r=s.config,t=s.state,i="number"==typeof r.replay_sampling_rate&&r.replay_sampling_rate>0?r.replay_sampling_rate:.1,a="/trackers/",o=n.currentScript;o&&o.src&&(a=o.src.substring(0,o.src.lastIndexOf("/")+1));var c=a+"rrweb.min.js",u=parseInt(sessionStorage.getItem("seentics_replay_seq")||"0"),l={buffer:[],sequence:u,isRecording:!1,isSending:!1,stopFn:null,lastFlush:Date.now()},f=function(){if(0===l.buffer.length||l.isSending)return Promise.resolve();l.isSending=!0;var n=l.buffer.slice(),i=l.sequence++;return sessionStorage.setItem("seentics_replay_seq",l.sequence.toString()),l.buffer=[],l.lastFlush=Date.now(),s.api.send("replays/record",{website_id:r.websiteId,session_id:t.sessionId,events:n,sequence:i,page:e.location.pathname}).catch(function(e){e.message&&e.message.includes("400")||l.buffer.length<2e3&&(l.buffer=n.concat(l.buffer),l.sequence--)}).finally(function(){l.isSending=!1})};Math.random()>i||function(){if(e.rrweb)return Promise.resolve();var s=function(e){return new Promise(function(s,r){var t=n.createElement("script");t.src=e,t.async=!0,t.onload=s,t.onerror=r,n.head.appendChild(t)})};return s(c).catch(function(){return s("https://cdn.jsdelivr.net/npm/rrweb@2.0.0-alpha.18/dist/rrweb.umd.js")})}().then(function(){e.rrweb?(l.stopFn=e.rrweb.record({emit:function(e){l.buffer.push(e),l.sequence===u&&l.buffer.length>=2&&f(),l.buffer.length>=500&&f()},maskAllInputs:!0,maskInputOptions:{password:!0,email:!0}}),l.stopFn&&(l.isRecording=!0,setInterval(f,1e4),e.addEventListener("beforeunload",function(){0!==l.buffer.length&&(navigator.sendBeacon(r.apiHost+"/api/v1/replays/record",new Blob([JSON.stringify({website_id:r.websiteId,session_id:t.sessionId,events:l.buffer,sequence:l.sequence++,page:e.location.pathname})],{type:"application/json"})),l.buffer=[])}),n.addEventListener("visibilitychange",function(){"hidden"===n.visibilityState&&f()}))):console.error("[Seentics Replay] rrweb failed to load")}).catch(function(e){console.error("[Seentics Replay] Init failed:",e)})}}(window,document);