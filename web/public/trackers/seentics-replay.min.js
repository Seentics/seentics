!function(e,n){"use strict";if(e.SEENTICS_CORE)s();else var t=setInterval(function(){e.SEENTICS_CORE&&(clearInterval(t),s())},100);function s(){var t=e.SEENTICS_CORE,s=t.config,r=t.state,i="number"==typeof s.replay_sampling_rate&&s.replay_sampling_rate>0?s.replay_sampling_rate:.1,a="/trackers/",o=n.currentScript;o&&o.src&&(a=o.src.substring(0,o.src.lastIndexOf("/")+1));var c=a+"rrweb.min.js",l=parseInt(sessionStorage.getItem("seentics_replay_seq")||"0"),u={buffer:[],sequence:l,isRecording:!1,isSending:!1,stopFn:null,lastFlush:Date.now()},f=function(){if(0===u.buffer.length||u.isSending)return Promise.resolve();u.isSending=!0;var n=u.buffer.slice(),i=u.sequence++;return sessionStorage.setItem("seentics_replay_seq",u.sequence.toString()),u.buffer=[],u.lastFlush=Date.now(),t.api.send("replays/record",{website_id:s.websiteId,session_id:r.sessionId,events:n,sequence:i,page:e.location.pathname}).catch(function(e){e.message&&e.message.includes("400")||u.buffer.length<2e3&&(u.buffer=n.concat(u.buffer),u.sequence--)}).finally(function(){u.isSending=!1})};Math.random()>i||function(){if(e.rrweb)return Promise.resolve();var t=function(e){return new Promise(function(t,s){var r=n.createElement("script");r.src=e,r.async=!0,r.onload=t,r.onerror=s,n.head.appendChild(r)})};return t(c).catch(function(){return t("https://cdn.jsdelivr.net/npm/rrweb@2.0.0-alpha.18/dist/rrweb.umd.js")})}().then(function(){if(e.rrweb){if(u.stopFn=e.rrweb.record({emit:function(e){u.buffer.push(e),u.sequence===l&&u.buffer.length>=2&&f(),u.buffer.length>=500&&f()},maskAllInputs:!0,maskInputOptions:{password:!0,email:!0}}),u.stopFn){u.isRecording=!0,u.startTime=Date.now();var t=setInterval(f,1e4);u.maxTimer=setTimeout(function(){clearInterval(t),f().then(function(){u.stopFn&&(u.stopFn(),u.stopFn=null),u.isRecording=!1})},18e5),e.addEventListener("beforeunload",function(){0!==u.buffer.length&&(navigator.sendBeacon(s.apiHost+"/api/v1/replays/record",new Blob([JSON.stringify({website_id:s.websiteId,session_id:r.sessionId,events:u.buffer,sequence:u.sequence++,page:e.location.pathname})],{type:"application/json"})),u.buffer=[])}),n.addEventListener("visibilitychange",function(){"hidden"===n.visibilityState&&f()})}}else console.error("[Seentics Replay] rrweb failed to load")}).catch(function(e){console.error("[Seentics Replay] Init failed:",e)})}}(window,document);