!function(e,t){"use strict";var a=e!==e.top;if(e.SEENTICS_CORE)i();else var n=setInterval(function(){e.SEENTICS_CORE&&(clearInterval(n),i())},100);function i(){var n=e.SEENTICS_CORE.config,i={buffer:[],maxBufferSize:100,flushInterval:3e4,lastMoveTime:0,moveThreshold:150,lastMoveX:-1,lastMoveY:-1,minMoveDistance:1,lastUrl:e.location.href,samplingRate:.1,enabled:!1!==n.heatmap_enabled},o=e.location.pathname,r=n.max_heatmaps||0,l=n.tracked_urls||[],s=l.includes(o);if(i.enabled&&r>0&&!s&&l.length>=r&&(i.enabled=!1),i.enabled||a){a||l.includes(o)||l.push(o);var c=function(){var a=t.documentElement,n=t.body||{scrollHeight:0,offsetHeight:0,clientWidth:0},i=n.getBoundingClientRect?n.getBoundingClientRect():{width:a.clientWidth,left:0};return{width:i.width||a.clientWidth||e.innerWidth,left:i.left+(e.pageXOffset||a.scrollLeft),height:Math.max(n.scrollHeight||0,a.scrollHeight,n.offsetHeight||0,a.offsetHeight,a.clientHeight)}},f=function(){var t=e.innerWidth;return t<768?"mobile":t<1024?"tablet":"desktop"},h=function(e){var t,a=c(),n=a.width||1,i=a.height||1,o=f();if("desktop"===o||"tablet"===o){var r="desktop"===o?1200:768;t=(r/2+(e.pageX-(a.left+n/2)))/r*1e3}else t=(e.pageX-a.left)/n*1e3;return{x:t,y:Math.min(1e3,Math.max(0,e.pageY/i*1e3))}},d=function(e){return e?e.length>1&&e.endsWith("/")?e.slice(0,-1):e:"/"},u=function(t,a,n,o){i.enabled&&(i.buffer.push({type:t,x:a,y:n,selector:o||"",url:d(e.location.pathname),device_type:f(),timestamp:Math.floor(Date.now()/1e3)}),i.buffer.length>=i.maxBufferSize&&p())},p=function(){if(0!==i.buffer.length){var e=i.buffer.slice();i.buffer=[],fetch(n.apiHost+"/api/v1/heatmaps/record",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({website_id:n.websiteId,points:e})}).catch(function(e){n.debug&&console.error("[Seentics Heatmap]",e)})}};if(e.addEventListener("message",function(a){if("SEENTICS_GET_DIMENSIONS"===a.data){var n=c(),i=n.height,o=n.width;if(i<=e.innerHeight+100)try{for(var r=t.querySelectorAll("div, main, section"),l=0;l<r.length;l++){var s=r[l];if(s.scrollHeight>i&&s.scrollHeight<1e4){var f=e.getComputedStyle(s);"auto"!==f.overflowY&&"scroll"!==f.overflowY||"none"===f.display||(i=s.scrollHeight,s.scrollWidth>o&&(o=s.scrollWidth))}}}catch(e){}a.source.postMessage({type:"SEENTICS_DIMENSIONS",height:i,width:n.width,left:n.left-(e.pageXOffset||t.documentElement.scrollLeft),totalWidth:n.width,url:e.location.href},"*")}a.data&&"SEENTICS_SET_SCROLL"===a.data.type&&e.scrollTo(a.data.left||0,a.data.top||0)}),e.addEventListener("scroll",function(){e.parent!==e&&e.parent.postMessage({type:"SEENTICS_SCROLL",scrollTop:e.pageYOffset||t.documentElement.scrollTop,scrollLeft:e.pageXOffset||t.documentElement.scrollLeft},"*")},{passive:!0}),!a){u("pageview",0,0);var v={maxDepth:0,sentBands:{},lastScrollTime:0},m=function(){var a=e.pageYOffset||t.documentElement.scrollTop,n=e.innerHeight,i=c(),o=Math.min(1e3,Math.round((a+n)/(i.height||1)*1e3));if(!(o<=v.maxDepth)){v.maxDepth=o;for(var r=0;r<=o;r+=50)v.sentBands[r]||(v.sentBands[r]=!0,u("scroll",500,r))}};e.addEventListener("scroll",function(){var e=Date.now();e-v.lastScrollTime<2e3||(v.lastScrollTime=e,m())},{passive:!0}),setTimeout(m,1e3),t.addEventListener("mousemove",function(e){var t=Date.now();if(!(t-i.lastMoveTime<i.moveThreshold||Math.random()>i.samplingRate)){var a=h(e);Math.abs(a.x-i.lastMoveX)<i.minMoveDistance&&Math.abs(a.y-i.lastMoveY)<i.minMoveDistance||(i.lastMoveTime=t,i.lastMoveX=a.x,i.lastMoveY=a.y,u("move",a.x,a.y))}},{passive:!0});var g=[];t.addEventListener("click",function(a){var n=h(a),i=function(e){if(!(e instanceof Element))return"";for(var t=[];e.nodeType===Node.ELEMENT_NODE;){var a=e.nodeName.toLowerCase();if(e.id){t.unshift(a+"#"+e.id);break}for(var n=e,i=1;n=n.previousElementSibling;)n.nodeName.toLowerCase()===a&&i++;1!==i&&(a+=":nth-of-type("+i+")"),t.unshift(a),e=e.parentNode}return t.join(" > ")}(a.target),o=Date.now();u("click",n.x,n.y,i),g.push({time:o,selector:i,x:n.x,y:n.y});for(var r=[],l=0;l<g.length;l++)o-g[l].time<1e3&&r.push(g[l]);g=r;for(var s=0,c=0;c<r.length;c++)r[c].selector===i&&s++;s>=3&&(u("rage_click",n.x,n.y,i),g=[]);var f=a.target,d=f.tagName?f.tagName.toLowerCase():"",p="a"===d||"button"===d||"input"===d||"select"===d;if(!p&&f.getAttribute&&(p="button"===f.getAttribute("role")||!!f.getAttribute("onclick")),!p)for(var v=f.parentElement,m=0;m<3&&v;m++){var b=v.tagName?v.tagName.toLowerCase():"";if("a"===b||"button"===b||v.getAttribute&&"button"===v.getAttribute("role")){p=!0;break}v=v.parentElement}if(p){var E=e.location.href,S=!1,y=new MutationObserver(function(){S=!0});try{y.observe(t.body,{childList:!0,subtree:!0,attributes:!0})}catch(e){}setTimeout(function(){y.disconnect(),S||e.location.href!==E||u("dead_click",n.x,n.y,i)},1e3)}}),setInterval(p,i.flushInterval),e.addEventListener("beforeunload",function(){m(),0!==i.buffer.length&&(navigator.sendBeacon(n.apiHost+"/api/v1/heatmaps/record",new Blob([JSON.stringify({website_id:n.websiteId,points:i.buffer})],{type:"application/json"})),i.buffer=[])}),t.addEventListener("visibilitychange",function(){"hidden"===t.visibilityState&&p()});var b=history.pushState,E=history.replaceState,S=function(){var t=d(e.location.pathname);t!==d(new URL(i.lastUrl).pathname)&&(p(),i.lastUrl=e.location.href,r>0&&(i.enabled=l.includes(t)||l.length<r),i.enabled&&(l.includes(t)||l.push(t),u("pageview",0,0)))};history.pushState=function(){b.apply(this,arguments),S()},history.replaceState=function(){E.apply(this,arguments),S()},e.addEventListener("popstate",S)}}}}(window,document);